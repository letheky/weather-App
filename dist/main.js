(()=>{feather.replace();const e="eae716dc50073d95e2f23037e30a6283",t=document.querySelector.bind(document),n=document.querySelectorAll.bind(document),a=t(".loader"),r=t("input"),i=t("button"),c=t(".date-dayname"),o=t(".date-day"),s=t(".location"),l=t(".weather-temp"),u=t(".weather-desc"),h=n(".value"),d=t(".week-list"),p=d.querySelectorAll(".day-name"),m=d.querySelectorAll(".day-temp");async function y(e){const n=t(".weather-container").querySelector(".weather-icon"),y=d.querySelectorAll(".day-icon");a.setAttribute("style","visibility:visible;"),i.setAttribute("style","opacity:0.5;");const v=await fetch(e);404===v.status&&(window.alert("Vui lòng nhập đúng tên thành phố"),r.value="");const C=await v.json();a.setAttribute("style","visibility:hidden;"),i.setAttribute("style","opacity:1;");const k=new Date,x=function(e,t){const n={temp:"",desc:"",feels_like:"",humidity:"",wind:"",type:""};for(let a=0;a<t.length;a++)if(e.getHours()<Number(t[a].dt_txt.slice(11,13))){n.temp=t[a].main.temp,n.feels_like=t[a].main.feels_like,n.humidity=t[a].main.humidity,n.desc=t[a].weather[0].description,n.type=t[a].weather[0].main,n.wind=t[a].wind.speed;break}return n}(k,C.list),S={day:b(k),date:k,location:C.city.name+", "+C.city.country,...x};c.textContent=S.day,o.textContent=`${S.date.getDate()} ${function(e){switch(e){case 1:return"tháng 2";case 2:return"tháng 3";case 3:return"tháng 4";case 4:return"tháng 5";case 5:return"tháng 6";case 6:return"tháng 7";case 7:return"tháng 8";case 8:return"tháng 9";case 9:return"tháng 10";case 10:return"tháng 11";case 11:return"tháng 12";default:return"tháng 1"}}(S.date.getMonth())}, ${S.date.getFullYear()}`,s.textContent=S.location,l.textContent=Math.ceil(Number(S.temp))+"°C",u.textContent=function(e){const t=e.split(" ");for(var n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join(" ")}(S.desc),w(S.type,n,f),h.forEach(((e,t)=>{0===t&&(e.textContent=Math.ceil(Number(S.feels_like))+"°C"),1===t&&(e.textContent=S.humidity+"%"),2===t&&(e.textContent=S.wind+" km/h")})),p.forEach(((e,t)=>{const n=new Date(C.list[8*(t+1)-1].dt_txt);e.textContent=b(n),m[t].textContent=Math.ceil(C.list[8*(t+1)-1].main.temp)+"°C",w(C.list[8*(t+1)-1].weather[0].main,y[t],g)}))}function f(e){let t=document.createElement("div");return t.classList.add("weather-icon"),t.innerHTML=e,t}function g(e){let t=document.createElement("div");return t.classList.add("day-icon"),t.innerHTML=e,t}function w(e,t,n){switch(e){case"Clear":t.replaceWith(n(feather.icons.sun.toSvg()));break;case"Rain":t.replaceWith(n(feather.icons["cloud-rain"].toSvg()));break;case"Clouds":t.replaceWith(n(feather.icons.cloud.toSvg()));break;default:t.replaceWith(n(feather.icons["cloud-snow"].toSvg()))}}function b(e){switch(e.getDay()){case 1:return"Thứ 2";case 2:return"Thứ 3";case 3:return"Thứ 4";case 4:return"Thứ 5";case 5:return"Thứ 6";case 6:return"Thứ 7";default:return"Chủ nhật"}}y(`http://api.openweathermap.org/data/2.5/forecast?q=Hanoi&lang=vi&appid=${e}&units=metric`),i.onclick=()=>{y(`http://api.openweathermap.org/data/2.5/forecast?q=${r.value}&lang=vi&appid=${e}&units=metric`)},r.addEventListener("keypress",(function(e){"Enter"===e.key&&(e.preventDefault(),i.click())}))})();